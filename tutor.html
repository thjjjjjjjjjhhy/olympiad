<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Need a Tutor - OlympiadPrep</title>
  <link rel="stylesheet" href="styles.css" />

  <style>
    /* ===== Page palette to match the site ===== */
    :root{
      --fg:#0f172a;           /* main text */
      --muted:#64748b;        /* secondary text */
      --grid:#e5e7eb;         /* borders */
      --card:#ffffff;         /* cards */
      --accent:#0ea5e9;       /* cyan */
      --accent-2:#2563eb;     /* indigo for CTAs */
      --chip-bg:#f8fafc;
      --shadow:0 1px 4px rgba(0,0,0,.06);
    }
    html,body{background:#fff;color:var(--fg)}
    .container{max-width:1100px;margin:0 auto;padding:0 16px}

    /* ===== Header (same as home/timeline) ===== */
    .site-header{
      position:sticky; top:0; z-index:10;
      background: linear-gradient(90deg,#3b82f6 0%, #6366f1 100%) !important;
      color:#fff; padding:12px 0; margin-bottom:18px;
    }
    .site-header .container{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
    }
    .brand-nav{ display:flex; align-items:center; gap:16px; flex-wrap:wrap; }
    .logo{ font-weight:800; letter-spacing:.2px; color:#fff; }
    .site-nav{ display:flex; gap:14px; flex-wrap:wrap; }
    .site-nav a{ color:#fff; text-decoration:none; font-weight:600; opacity:.95 }
    .site-nav a:hover{ opacity:1; text-decoration:underline }
    .site-nav a.active{ border-bottom:2px solid rgba(255,255,255,.9); padding-bottom:2px }
    #auth-slot{ display:flex; align-items:center; gap:10px; min-height:32px }

    /* ===== Hero (force dark text so it‚Äôs readable) ===== */
    .hero{ padding:8px 0 0 }
    .hero h2{ margin:.25rem 0 .5rem; color:var(--fg) !important; display:flex; align-items:center; gap:10px }
    .hero h2 .emoji{ display:inline-flex; align-items:center; justify-content:center;
                     width:28px; height:28px; border-radius:8px; background:#eff6ff; border:1px solid var(--grid); }
    .hero p{ color:var(--muted) !important; margin:0 0 10px }

    /* ===== Layout: form + info card ===== */
    .grid{ display:grid; grid-template-columns:1.1fr .9fr; gap:14px; align-items:start; }
    @media (max-width:900px){ .grid{ grid-template-columns:1fr; } }

    .card{ background:var(--card); border:1px solid var(--grid); border-radius:16px; box-shadow:var(--shadow); padding:16px; }
    .card h3{ margin:.2rem 0 .65rem }
    .bullet{ margin:0; padding-left:18px; color:var(--fg) }
    .bullet li{ margin:.4rem 0 }
    .muted{ color:var(--muted) }

    /* ===== Form ===== */
    .tutor-form{ display:grid; gap:12px; }
    .two-col{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    @media (max-width:700px){ .two-col{ grid-template-columns:1fr; } }
    .form-group{ display:grid; gap:6px; }
    .tutor-form label{ color:var(--fg) !important; font-weight:600 }
    .tutor-form .note{ color:var(--muted) !important; font-weight:400 }
    .tutor-form input, .tutor-form select, .tutor-form textarea{
      border:1px solid var(--grid); border-radius:12px; padding:10px; background:#fff; color:var(--fg);
    }
    .tutor-form input::placeholder,
    .tutor-form textarea::placeholder{ color:#94a3b8 }
    .tutor-form button{
      cursor:pointer; border:0; background:var(--accent-2); color:#fff;
      padding:10px 16px; border-radius:12px; font-weight:800; width:fit-content;
    }
    .success, .error{ margin-top:10px; padding:10px 12px; border-radius:10px; display:none }
    .success{ background:#ecfdf5; border:1px solid #a7f3d0; color:#065f46 }
    .error{ background:#fef2f2; border:1px solid #fecaca; color:#7f1d1d }

    /* Honeypot (hidden anti-bot field) */
    .hp-wrap{ position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden; }

    /* Print */
    @media print{
      .site-header{ display:none !important }
      .card{ box-shadow:none; border:1px solid var(--grid) }
    }
  </style>
</head>

<body>
  <!-- ===== Header ===== -->
  <header class="site-header">
    <div class="container">
      <div class="brand-nav">
        <h1 class="logo">OlympiadPrep</h1>
        <nav class="site-nav">
          <a href="index.html">Home</a>
          <a href="timeline.html">Timeline</a>
          <a href="tutor.html" class="active">Need a Tutor</a>
          <a href="books.html">Books</a>
        </nav>
      </div>
      <div id="auth-slot"></div>
    </div>
  </header>

  <!-- ===== Hero ===== -->
  <section class="hero">
    <div class="container">
      <h2><span class="emoji">üë©‚Äçüè´</span> Need a Tutor?</h2>
      <p>Contest-savvy mentors for AMC 8/10/12, AIME, and US(A)JMO. Tell us what you need ‚Äî we‚Äôll introduce the best fit.</p>
    </div>
  </section>

  <main class="container" style="margin-top:8px">
    <div class="grid">
      <!-- ===== Left: Form ===== -->
      <section class="card">
        <form id="tutor-form" class="tutor-form" novalidate>
          <!-- Required -->
          <div class="two-col">
            <div class="form-group">
              <label for="name">Name <span class="note">(required)</span></label>
              <input type="text" id="name" name="name" autocomplete="name" required />
            </div>
            <div class="form-group">
              <label for="email">Email <span class="note">(required)</span></label>
              <input type="email" id="email" name="email" autocomplete="email" required />
            </div>
          </div>

          <!-- Optional extras -->
          <div class="two-col">
            <div class="form-group">
              <label for="gradeLevel">Grade level <span class="note">(optional)</span></label>
              <select id="gradeLevel" name="gradeLevel">
                <option value="">Select‚Ä¶</option>
                <option>Middle school</option>
                <option>9th grade</option>
                <option>10th grade</option>
                <option>11th grade</option>
                <option>12th grade</option>
                <option>Gap year</option>
                <option>College</option>
                <option>Other</option>
              </select>
            </div>
            <div class="form-group">
              <label for="state">State <span class="note">(optional)</span></label>
              <select id="state" name="state">
                <option value="">Select‚Ä¶</option>
                <option>AL</option><option>AK</option><option>AZ</option><option>AR</option><option>CA</option>
                <option>CO</option><option>CT</option><option>DE</option><option>DC</option><option>FL</option>
                <option>GA</option><option>HI</option><option>ID</option><option>IL</option><option>IN</option>
                <option>IA</option><option>KS</option><option>KY</option><option>LA</option><option>ME</option>
                <option>MD</option><option>MA</option><option>MI</option><option>MN</option><option>MS</option>
                <option>MO</option><option>MT</option><option>NE</option><option>NV</option><option>NH</option>
                <option>NJ</option><option>NM</option><option>NY</option><option>NC</option><option>ND</option>
                <option>OH</option><option>OK</option><option>OR</option><option>PA</option><option>RI</option>
                <option>SC</option><option>SD</option><option>TN</option><option>TX</option><option>UT</option>
                <option>VT</option><option>VA</option><option>WA</option><option>WV</option><option>WI</option>
                <option>WY</option><option>Outside US</option>
              </select>
            </div>
          </div>

          <div class="two-col">
            <div class="form-group">
              <label for="school">School <span class="note">(optional)</span></label>
              <input type="text" id="school" name="school" placeholder="e.g., Lincoln High School" />
            </div>
            <div class="form-group">
              <label for="classes">Previous / Current math classes <span class="note">(optional)</span></label>
              <input type="text" id="classes" name="classes" placeholder="e.g., Algebra II, Precalculus, AoPS Intro NT" />
            </div>
          </div>

          <div class="form-group">
            <label for="needs">What do you need help with? <span class="note">(required)</span></label>
            <textarea id="needs" name="needs" rows="4" required placeholder="Topics, contests, goals, meeting times‚Ä¶"></textarea>
          </div>

          <!-- Honeypot to reduce spam -->
          <div class="hp-wrap">
            <label>Leave this field empty:
              <input type="text" name="_gotcha" tabindex="-1" autocomplete="off">
            </label>
          </div>

          <button type="submit">Submit</button>
          <div class="muted" style="margin-top:6px">We‚Äôll email you within 1‚Äì2 business days.</div>

          <div id="okMsg" class="success">Thank you! We‚Äôve received your request. We‚Äôll email you soon.</div>
          <div id="errMsg" class="error">Submission failed ‚Äî please try again in a moment.</div>
        </form>
      </section>

      <!-- ===== Right: Info card ===== -->
      <aside class="card">
        <h3>What to expect</h3>
        <ul class="bullet">
          <li><b>Tailored match.</b> We pair you with a mentor experienced in your goal (AMC 8 ‚Üí US(A)JMO).</li>
          <li><b>Clear plan.</b> Tutors align sessions with your <a href="timeline.html">study timeline</a>.</li>
          <li><b>Flexible cadence.</b> Weekly or bi-weekly; online via Zoom.</li>
          <li><b>Transparent goals.</b> Skills check-ins, timed sets, and review of mistakes.</li>
        </ul>
        <p class="muted" style="margin-top:8px">Tip: Include your contest dates and typical availability in the message.</p>
      </aside>
    </div>
  </main>

  <footer class="container" style="text-align:center;margin:20px 0;color:#64748b">
    ¬© 2025 OlympiadPrep. Empowering tomorrow‚Äôs problem solvers.
  </footer>

  <!-- Email + optional cloud save -->
  <script type="module">
    // Replace with your Formspree endpoint
    const FORMSPREE_ENDPOINT = "https://formspree.io/f/mldwopzp";

    let currentUser = null;
    window.addEventListener("olympAuthReady", () => {
      try { currentUser = window.olympAuth?.getUser?.() || null; } catch {}
    });

    const form  = document.getElementById('tutor-form');
    const okMsg = document.getElementById('okMsg');
    const errMsg= document.getElementById('errMsg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      okMsg.style.display = 'none';
      errMsg.style.display = 'none';

      const data = Object.fromEntries(new FormData(form).entries());
      if(!data.name || !data.email || !data.needs){
        errMsg.textContent = "Please fill out name, email, and what you need help with.";
        errMsg.style.display = 'block';
        return;
      }

      const payload = {
        name: data.name,
        email: data.email,
        gradeLevel: data.gradeLevel || '',
        state: data.state || '',
        school: data.school || '',
        classes: data.classes || '',
        needs: data.needs,
        page: location.href,
        userUid: currentUser?.uid || '',
        userDisplay: currentUser?.displayName || '',
        userEmail: currentUser?.email || ''
      };

      try {
        const r = await fetch(FORMSPREE_ENDPOINT, {
          method: "POST",
          headers: { "Accept":"application/json", "Content-Type":"application/json" },
          body: JSON.stringify(payload)
        });
        if (!r.ok) throw new Error("Email service returned " + r.status);
        okMsg.style.display = 'block';
        form.reset();
      } catch (err) {
        console.error(err);
        errMsg.style.display = 'block';
        errMsg.textContent = "Submission failed ‚Äî please try again.";
      }
    });
  </script>

  <!-- Auth (same file you already use) -->
  <script type="module" src="./auth.js"></script>
</body>
</html>
