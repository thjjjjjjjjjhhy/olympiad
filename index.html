<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OlympiadPrep - Home</title>
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1 class="logo">OlympiadPrep</h1>
      <nav class="site-nav">
        <a href="index.html" class="active">Home</a>
        <a href="timeline.html">Timeline</a>
        <a href="tutor.html">Need a Tutor</a>
        <a href="books.html">Books</a>
      </nav>
    </div>
  </header>
  <section class="hero">
    <div class="container">
      <h2>Find any contest problem instantly</h2>
      <p class="subtitle">Your AI-powered companion for Olympiad success.</p>
      <form class="lookup-form" onsubmit="handleSearch(event)">
        <input type="text" id="lookup-query" placeholder="e.g. AMC 12B 2023 Problem 14 or AIME I 2022" required>
        <button type="submit">Search</button>
      </form>
    </div>
  </section>
  <main class="features container">
    <div class="card">
      <h3>📅 Build a Timeline</h3>
      <p>Plan your preparation with a clear schedule.</p>
      <a href="planning.html">Start Planning →</a>
    </div>
    <div class="card">
      <h3>👩‍🏫 Need a Tutor?</h3>
      <p>Connect with experienced mentors for one-on-one help.</p>
      <a href="tutor.html">Find a Tutor →</a>
    </div>
    <div class="card">
      <h3>📚 Recommended Books</h3>
      <p>Explore curated reading to sharpen your skills.</p>
      <a href="books.html">Browse Books →</a>
    </div>
  </main>

  <footer>
    © 2025 OlympiadPrep. Empowering tomorrow’s problem solvers.
  </footer>

  <!-- Existing script -->
  <script>
    function handleSearch(event) {
      event.preventDefault();
      const q = document.getElementById('lookup-query').value.toUpperCase();
      const tokens = q.replace(/[^A-Z0-9]/g, ' ').split(/\s+/).filter(Boolean);

      let year, problem, contest, level, variant;

      tokens.forEach(t => {
        if (!year && /^\d{4}$/.test(t)) {
          year = t;
          return;
        }
        if (t === 'USAMO') {
          contest = 'USAMO';
          return;
        }
        if (t.startsWith('AIME')) {
          contest = 'AIME';
          const m = t.match(/AIME(.*)/);
          if (m && m[1]) variant = m[1];
          return;
        }
        if (t === 'AIME') {
          contest = 'AIME';
          return;
        }
        if (t.startsWith('AMC')) {
          contest = 'AMC';
          const m = t.match(/AMC(\d*)([AB])?/);
          if (m) {
            if (m[1]) level = m[1];
            if (m[2]) variant = m[2];
          }
          return;
        }
        if (contest === 'AMC' && !level) {
          const m = t.match(/(8|10|12)([AB])?/);
          if (m) {
            level = m[1];
            if (m[2]) variant = m[2];
            return;
          }
        }
        if (contest === 'AMC' && !variant && /^[AB]$/.test(t)) {
          variant = t;
          return;
        }
        if (contest === 'AIME' && !variant && /^(I|II|1|2)$/.test(t)) {
          variant = t.replace('1', 'I').replace('2', 'II');
          return;
        }
        if (!problem && /^\d{1,2}$/.test(t)) {
          problem = t;
        }
      });

      if (contest === 'AIME' && variant) {
        variant = variant.replace('1', 'I').replace('2', 'II').toUpperCase();
      }

      let url = null;
      if (!year || !contest) {
        alert('Please include a year and contest');
        return;
      }

      if (problem) {
        if (contest === 'AMC') {
          if (!level) {
            alert('Please specify AMC level (8, 10, or 12)');
            return;
          }
          if (parseInt(year) >= 2002) {
            if (!variant) {
              alert('Please specify A or B');
              return;
            }
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AMC_${level}${variant}_Problems/Problem_${problem}`;
          } else {
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AMC_${level}_Problems/Problem_${problem}`;
          }
        } else if (contest === 'AIME') {
          if (parseInt(year) >= 2000) {
            variant = variant || 'I';
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AIME_${variant}_Problems/Problem_${problem}`;
          } else {
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AIME_Problems/Problem_${problem}`;
          }
        } else if (contest === 'USAMO') {
          url = `https://artofproblemsolving.com/wiki/index.php/${year}_USAMO_Problems/Problem_${problem}`;
        }
      } else {
        if (contest === 'AMC') {
          if (!level) {
            alert('Please specify AMC level (8, 10, or 12)');
            return;
          }
          if (parseInt(year) >= 2002) {
            if (!variant) {
              alert('Please specify A or B');
              return;
            }
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AMC_${level}${variant}_Problems`;
          } else {
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AMC_${level}_Problems`;
          }
        } else if (contest === 'AIME') {
          if (parseInt(year) >= 2000) {
            variant = variant || 'I';
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AIME_${variant}_Problems`;
          } else {
            url = `https://artofproblemsolving.com/wiki/index.php/${year}_AIME_Problems`;
          }
        } else if (contest === 'USAMO') {
          url = `https://artofproblemsolving.com/wiki/index.php/${year}_USAMO_Problems`;
        }
      }

      if (url) {
        window.open(url, '_blank');
      } else {
        alert('Unable to construct a link for that query');
      }
    }
  </script>

  
</body>
</html>
